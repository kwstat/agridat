<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Graphical Gems in the agridat Package • agridat</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Graphical Gems in the agridat Package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">agridat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.27</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/agridat_data.html">Additional sources of agricultural data</a></li>
    <li><a class="dropdown-item" href="../articles/agridat_graphical_gems.html">Graphical Gems in the agridat Package</a></li>
    <li><a class="dropdown-item" href="../articles/agridat_intro.html">Introduction to agridat</a></li>
    <li><a class="dropdown-item" href="../articles/agridat_mixed_model_example.html">Example generalized linear mixed model analysis with different packages</a></li>
    <li><a class="dropdown-item" href="../articles/agridat_uniformity_data.html">Notes on uniformity data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kwstat/agridat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Graphical Gems in the agridat Package</h1>
                        <h4 data-toc-skip class="author">Kevin
Wright</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kwstat/agridat/blob/main/vignettes/agridat_graphical_gems.Rmd" class="external-link"><code>vignettes/agridat_graphical_gems.Rmd</code></a></small>
      <div class="d-none name"><code>agridat_graphical_gems.Rmd</code></div>
    </div>

    
    
<p>The <code>agridat</code> package is an extensive collection of data
sets that have been previously published in books and journals,
primarily from agricultural experiments.</p>
<p>This vignette presents graphical views of a few of the datasets in
this package.</p>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>This exhibit of agricultural data uses the following packages:
<code>agridat</code>, <code>desplot</code>, <code>gge</code>,
<code>HH</code>, <code>lattice</code>, <code>latticeExtra</code>,
<code>mapproj</code>, <code>maps</code>, <code>reshape2</code>.</p>
</div>
<div class="section level2">
<h2 id="potato-blight-incidence-over-space-and-time">Potato blight incidence over space and time<a class="anchor" aria-label="anchor" href="#potato-blight-incidence-over-space-and-time"></a>
</h2>
<pre><code><span><span class="co">## Loading required package: desplot</span></span></code></pre>
<p><img src="agridat_graphical_gems_files/figure-html/lee1-1.png" class="r-plt" width="480"></p>
<p><span class="citation">@lee2009random</span> analyzed a large dataset
to evaluate the resistance of potato varieties to blight. This data
contains evaluations of a changing set of varieties every two years,
evaluated in 5 blocks, repeatedly throughout the growing season to track
the progress of the disease. Each panel shows a field map on the given
date, with a separate row of panels for each year.</p>
<p>Would you include field spatial trends in a model for these data?</p>
<pre><code><span><span class="co">## Loading required package: latticeExtra</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: lattice</span></span></code></pre>
<p><img src="agridat_graphical_gems_files/figure-html/lee2-1.png" class="r-plt" width="480"></p>
<p>In 1983, 20 varieties were evaluated in 5 blocks (shown by colored
numbers) throughout the growing season for disease resistance.
Resistance scores start at 9 for all varieties (shown in panels). As the
growing season progresses, the ‘I.HARDY’ variety succumbs quickly to
blight, while ‘IWA’ succumbs steadily, and ‘064.1’ resists blight until
near the end of the season.</p>
<p>Does this view show differences between blocks?</p>
</div>
<div class="section level2">
<h2 id="an-informative-prior">An informative prior<a class="anchor" aria-label="anchor" href="#an-informative-prior"></a>
</h2>
<p><img src="agridat_graphical_gems_files/figure-html/harrison-1.png" class="r-plt" width="480"></p>
<p><span class="citation">@harrison2012bayesian</span> used a Bayesian
approach to model daidzein levels in soybean samples. From 18 previous
publications, they extracted the published minimum and maximum daidzein
levels, and the number of samples tested. Each line in the dotplot shows
large, dark dots for one published minimum and maximum. The small dots
are imputed using a lognormal distribution.</p>
<p>All observed/imputed data were then used to fit a common lognormal
distribution that can be used as an informative prior. The common prior
is shown by the density at the top of the dotplot.</p>
<p>Do you think it is better to use a non-informative prior, or this
informative prior?</p>
</div>
<div class="section level2">
<h2 id="data-densities-for-a-binomial-glm">Data densities for a binomial GLM<a class="anchor" aria-label="anchor" href="#data-densities-for-a-binomial-glm"></a>
</h2>
<p><img src="agridat_graphical_gems_files/figure-html/mead-1.png" class="r-plt" width="480"></p>
<p><span class="citation">@mead2002statistical</span> present data for
germination of seeds under four temperatures (T1-T4) and four chemical
concentrations. For each of the 4*4=16 treatments, 50 seeds were tested
in each of four reps. In the graphic, each point is one rep. The blue
line is a fitted curve from a GLM with Temperature as a factor and log
concentration as a covariate. The gray lines show the central 95 percent
of the binomial density at that position.</p>
<p>Does this display help you understand the logit link and changing
shape of the binomial density?</p>
</div>
<div class="section level2">
<h2 id="verification-of-experiment-layout">Verification of experiment layout<a class="anchor" aria-label="anchor" href="#verification-of-experiment-layout"></a>
</h2>
<p><img src="agridat_graphical_gems_files/figure-html/gomez-1.png" class="r-plt" width="480"></p>
<p><span class="citation">@gomez1984statistical</span> provide data for
an experiment with 3 reps, 6 genotypes, 3 levels of nitrogen and 2
planting dates. The experiment layout is putatively a ‘’split
strip-plot’’. To verify the design, the <code>desplot</code> package is
used for plotting the design of field experiments.</p>
<p>How is the design different from a ‘’split-split-plot’’ design?</p>
</div>
<div class="section level2">
<h2 id="visualizing-main-effects-two-way-interactions">Visualizing main effects, two-way interactions<a class="anchor" aria-label="anchor" href="#visualizing-main-effects-two-way-interactions"></a>
</h2>
<pre><code><span><span class="co">## Loading required package: HH</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: grid</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: multcomp</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: mvtnorm</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: survival</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: TH.data</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: MASS</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'TH.data'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:MASS':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     geyser</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: gridExtra</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'HH'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     is.R</span></span></code></pre>
<p><img src="agridat_graphical_gems_files/figure-html/gomez2-1.png" class="r-plt" width="480"></p>
<p><span class="citation">@heiberger2004statistical</span> provide an
interesting way to use lattice graphics to visualize the main effects
(using boxplots) and interactions (using interaction plots) in data.
Rice yield is plotted versus replication, nitrogen, management type, and
genotype variety. Box plots show minor differences between reps,
increaing yield due to nitrogen, high yield from intensive management,
and large differences between varieties.</p>
<p>Do you think interaction plots show interaction (lack of
parallelism)?</p>
</div>
<div class="section level2">
<h2 id="d-yield-response-to-fertilizers">3D yield response to fertilizers<a class="anchor" aria-label="anchor" href="#d-yield-response-to-fertilizers"></a>
</h2>
<p>Note: This image was created by manual manipulation of an
<code>rgl</code> device. The manual manipulation makes this
non-reproducible in an <code>Rmd</code> file. See the example for the
<code>sinclair.clover</code> data for the code.</p>
<p></p>
<p><span class="citation">@sinclair1994sulphur</span> examined clover
yields as a function of sulfur and phosphorous fertilizer in a
factorial-treatment experiment. <span class="citation">@dodds1996bivariate</span> modeled the yield response
using a Mitzerlisch-like equation that allows interacting curvature in
two dimensions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>i</mi><mi>e</mi><mi>l</mi><mi>d</mi><mo>=</mo><mi>α</mi><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>β</mi><mo>*</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>σ</mi><mo>+</mo><mi>τ</mi><mo>*</mo><mi>x</mi></mrow><mrow><mi>x</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>y</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>δ</mi><mo>*</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>θ</mi><mo>+</mo><mi>ρ</mi><mo>*</mo><mi>y</mi></mrow><mrow><mi>y</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>x</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
yield = \alpha * \left( 1 + \beta *\left(\frac{\sigma + \tau*x}{x+1}\right)^y\right) *
\left( 1+\delta*\left(\frac{\theta + \rho *y}{y+1}\right)^x \right)
</annotation></semantics></math></p>
<p>The blue dots are observed data, and the tan surface is the fitted
surface drawn by the <code>rgl</code> package).</p>
<p>How would you decide the optimal fertilizer levels?</p>
</div>
<div class="section level2">
<h2 id="mosaic-plot-of-potato-damage-from-harvesting">Mosaic plot of potato damage from harvesting<a class="anchor" aria-label="anchor" href="#mosaic-plot-of-potato-damage-from-harvesting"></a>
</h2>
<p><img src="agridat_graphical_gems_files/figure-html/keen-1.png" class="r-plt" width="672"></p>
<p><span class="citation">@keen1997analysis</span> looked at damage to
potatoes caused by lifting rods during harvest. In this experiment,
eight types of lifting rods were compared. Two energy levels, six
genotypes and three weight classes were used. For each combinations of
treatments, about 20 potato tubers were rated as undamaged (D1, yellow)
to severely damaged (D4, red). Counts per treatment are shown in a
mosaic plot.</p>
<p>Which style of lifting rods cause the least/most damage to
potatoes?</p>
</div>
<div class="section level2">
<h2 id="yield-vs-covariate-for-latticebarley">Yield vs covariate for lattice::barley<a class="anchor" aria-label="anchor" href="#yield-vs-covariate-for-latticebarley"></a>
</h2>
<p><img src="agridat_graphical_gems_files/figure-html/wright-1.png" class="r-plt" width="480"></p>
<p><span class="citation">@wright2013revisiting</span> investigated the
<code><a href="https://rdrr.io/pkg/lattice/man/barley.html" class="external-link">lattice::barley</a></code> data. The original two years of data were
extended to 10 years (from original source documents), and supplemented
with weather covariates for the 6 locations and 10 years. Each panel
shows a scatterplot and regression for average location yield verses the
weather covariate. Horizontal strips are for locations, vertical strips
are for covariates: cdd = Cooling Degree Days, hdd = Heating Degree
Days, precip = Precipitation). Higher values of heating imply cooler
weather. Each plotting symbol is the last digit of the year (1927-1936)
for that location.</p>
<p>Does barley yield better in cooler or warmer weather?</p>
</div>
<div class="section level2">
<h2 id="gge-biplot">GGE biplot<a class="anchor" aria-label="anchor" href="#gge-biplot"></a>
</h2>
<p><span class="citation">@laffont2013genotype</span> developed a
variation of the GGE (genotype plus genotype-by-environment) biplot to
include auxiliary information about a block/group of environments. Each
location is classified into one of two mega-environments (colored). The
mosaic plots partition variation simultaneously by principal component
axis and source (genotype, genotype-by-block, residual).</p>
<p>Which genotypes are best to each mega-environment?</p>
</div>
<div class="section level2">
<h2 id="nebraska-farming-income-choropleth">Nebraska farming income choropleth<a class="anchor" aria-label="anchor" href="#nebraska-farming-income-choropleth"></a>
</h2>
<pre><code><span><span class="co">## Loading required package: maps</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: mapproj</span></span></code></pre>
<p><img src="agridat_graphical_gems_files/figure-html/nebr1-1.png" class="r-plt" width="480"></p>
<p>The Red-Blue palette in the <code>RColorBrewer</code> package is a
divergent palette with light colors near the middle of the scale. This
can cause problems when there are missing values, which appear as white
(technically, the background). In order to increase the visibility of
missing values, the <code>agridat</code> package uses a Red-Gray-Blue
palette, with a gray color that is dark enough to clearly distinguish
missing values.</p>
<p>How does the outlier county (Butler) in northeast Nebraska limit
interpration of spatial patterns in the data?</p>
<p><img src="agridat_graphical_gems_files/figure-html/nebr2-1.png" class="r-plt" width="480"></p>
<p>Because counties are different sizes, the second graphic uses an
income rate per square mile. Because of the outlier, it might be smart
to use percentile break points, but doing so hides the outlier. Instead,
the break points are calculated using a method called Fisher-Jenks.
These break points show both the outlier and the spatial patterns. It is
now easy to see that northwest (Sandhills) Nebraska has low farming
income, especially for crops. Counties with missing data are white,
which is easily distinguished from gray.</p>
<p>Where are farm incomes highest? Why?</p>
</div>
<div class="section level2">
<h2 id="las-rosas-yield-monitor">Las Rosas yield monitor<a class="anchor" aria-label="anchor" href="#las-rosas-yield-monitor"></a>
</h2>
<p><img src="agridat_graphical_gems_files/figure-html/lasrosas-1.png" class="r-plt" width="480"></p>
<p><span class="citation">@anselin2004spatial</span> and <span class="citation">@lambert2004comparison</span> looked at yield monitor
data collected from a corn field in Argentina in 1999 and 2001, to see
how yield was affected by field topography and nitrogen fertilizer. The
figures here show heatmaps for the yield each year, and also the
experiment design (colors are reps, shades of color are nitrogen level,
plotting character is topography).</p>
<p>Which year showed greater spatial variation in yield?</p>
</div>
<div class="section level2">
<h2 id="time-series-of-corn-yields-by-state">Time series of corn yields by state<a class="anchor" aria-label="anchor" href="#time-series-of-corn-yields-by-state"></a>
</h2>
<p><img src="agridat_graphical_gems_files/figure-html/nass-1.png" class="r-plt" width="480"></p>
<p>The National Agricultural Statistics Service tracks the total number
of acres planted to corn (and other crops) for each state in the U.S.
There are large changes over the past century in corn acreage for
selected states.</p>
<p>Which states were in the corn belt in 1925?</p>
<p>Which states were in the corn belt in 2000?</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
