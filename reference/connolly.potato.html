<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Potato yields in single-drill plots — connolly.potato • agridat</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Potato yields in single-drill plots — connolly.potato"><meta name="description" content="Potato yields in single-drill plots"><meta property="og:description" content="Potato yields in single-drill plots"><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">agridat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.27</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/agridat_data.html">Additional sources of agricultural data</a></li>
    <li><a class="dropdown-item" href="../articles/agridat_graphical_gems.html">Graphical Gems in the agridat Package</a></li>
    <li><a class="dropdown-item" href="../articles/agridat_intro.html">Introduction to agridat</a></li>
    <li><a class="dropdown-item" href="../articles/agridat_mixed_model_example.html">Example generalized linear mixed model analysis with different packages</a></li>
    <li><a class="dropdown-item" href="../articles/agridat_uniformity_data.html">Notes on uniformity data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kwstat/agridat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Potato yields in single-drill plots</h1>

      <div class="d-none name"><code>connolly.potato.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Potato yields in single-drill plots</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"connolly.potato"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p>A data frame with 80 observations on the following 6 variables.</p><dl><dt><code>rep</code></dt>
<dd><p>block</p></dd>

    <dt><code>gen</code></dt>
<dd><p>variety</p></dd>

    <dt><code>row</code></dt>
<dd><p>row</p></dd>

    <dt><code>col</code></dt>
<dd><p>column</p></dd>

    <dt><code>yield</code></dt>
<dd><p>yield, kg/ha</p></dd>

    <dt><code>matur</code></dt>
<dd><p>maturity group</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>Connolly et el use this data to illustrate how yield can be affected
  by competition from neighboring plots.</p>
<p>This data uses M1, M2, M3 for maturity, while Connolly et al use
  FE (first early), SE (second early) and M (maincrop).</p>
<p>The trial was 20 sections, each of which was an independent row of 20
  drills.  The data here are four reps of single-drill plots from
  sections 1, 6, 11, and 16.</p>
<p>The neighbor covariate for a plot is defined as the average of the
  plots to the left and right.  For drills at the edge of the trial, the
  covariate was the average of the one neighboring plot yield and the
  section (i.e. rep) mean.</p>
<p>It would be interesting to fit a model that uses differences in
  maturity between a plot and its neighbor as the actual covariate.</p>
<p>https://doi.org/10.1111/j.1744-7348.1993.tb04099.x</p>
<p>Used with permission of Iain Currie.</p>
    </div>
    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>Connolly, T and Currie, ID and Bradshaw, JE and McNicol, JW. (1993).
  Inter-plot competition in yield trials of potatoes
  <em>Solanum tuberosum L.</em> with single-drill plots.
  Annals of Applied Biology, 123, 367-377.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Chaves, S.F.S., Ferreira, F.M., Ferreira, G.C. et al.
  Incorporating spatial and genetic competition into breeding pipelines
  with the R package gencomp.
  Heredity (2025).
  https://doi.org/10.1038/s41437-024-00743-9</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kwstat.github.io/agridat/" class="external-link">agridat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">connolly.potato</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">connolly.potato</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Field plan</span></span></span>
<span class="r-in"><span><span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">desplot</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">desplot</span><span class="op">(</span><span class="va">dat</span>, <span class="va">yield</span><span class="op">~</span><span class="va">col</span><span class="op">*</span><span class="va">row</span>,</span></span>
<span class="r-in"><span>        out1<span class="op">=</span><span class="va">rep</span>, <span class="co"># aspect unknown</span></span></span>
<span class="r-in"><span>        main<span class="op">=</span><span class="st">"connolly.potato yields (reps not contiguous)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="connolly.potato-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Later maturities are higher yielding</span></span></span>
<span class="r-in"><span><span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">lattice</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">bwplot</a></span><span class="op">(</span><span class="va">yield</span><span class="op">~</span><span class="va">matur</span>, <span class="va">dat</span>, main<span class="op">=</span><span class="st">"connolly.potato yield by maturity"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="connolly.potato-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Observed raw means. Matches Connolly table 2.</span></span></span>
<span class="r-in"><span><span class="va">mn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">yield</span><span class="op">~</span><span class="va">gen</span>, data<span class="op">=</span><span class="va">dat</span>, FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mn</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">mn</span><span class="op">$</span><span class="va">yield</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    gen  yield</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  V08 16.200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 V19 14.450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 V10 13.925</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 V12 13.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  V07 13.300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 V20 12.975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 V14 12.975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  V06 12.625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 V11 12.575</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 V16 11.900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  V03 11.650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  V09 11.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  V01 11.275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 V18 10.650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  V02 10.325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 V17 10.200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 V15 10.125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 V13 10.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  V04  9.425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  V05  9.275</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a covariate which is the average of neighboring plot yields</span></span></span>
<span class="r-in"><span><span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">reshape2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu">acast</span><span class="op">(</span><span class="va">dat</span>, <span class="va">row</span><span class="op">~</span><span class="va">col</span>, value.var<span class="op">=</span><span class="st">'yield'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow<span class="op">=</span><span class="fl">4</span>, ncol<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">19</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mat</span><span class="op">[</span> , <span class="fl">1</span><span class="op">:</span><span class="fl">18</span><span class="op">]</span> <span class="op">+</span> <span class="va">mat</span><span class="op">[</span> , <span class="fl">3</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">mat2</span><span class="op">[</span> , <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mat</span><span class="op">[</span> , <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mat</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">mat2</span><span class="op">[</span> , <span class="fl">20</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mat</span><span class="op">[</span> , <span class="fl">20</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mat</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu">melt</span><span class="op">(</span><span class="va">mat2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'row'</span>,<span class="st">'col'</span>,<span class="st">'cov'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">dat2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># xyplot(yield ~ cov, data=dat, type=c('p','r'))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Connolly et al fit a model with avg neighbor yield as a covariate</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">gen</span> <span class="op">+</span> <span class="va">rep</span> <span class="op">+</span> <span class="va">cov</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">[</span><span class="st">'cov'</span><span class="op">]</span> <span class="co"># = -.303  (Connolly obtained -.31)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        cov </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.3030545 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Block names and effects</span></span></span>
<span class="r-in"><span><span class="va">bnm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R1"</span>,<span class="st">"R2"</span>,<span class="st">"R3"</span>,<span class="st">"R4"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'repR2'</span>,<span class="st">'repR3'</span>,<span class="st">'repR4'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Variety names and effects</span></span></span>
<span class="r-in"><span><span class="va">vnm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, width<span class="op">=</span><span class="fl">2</span>, flag<span class="op">=</span><span class="st">'0'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">veff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Adjust yield for variety and block effects</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat</span>, yadj <span class="op">=</span> <span class="va">yield</span> <span class="op">-</span> <span class="va">beff</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">rep</span>,<span class="va">bnm</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>                <span class="op">-</span> <span class="va">veff</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">gen</span>,<span class="va">vnm</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Similar to Connolly Fig 1.  Point pattern doesn't quite match</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">yadj</span><span class="op">~</span><span class="va">cov</span>, data<span class="op">=</span><span class="va">dat</span>, type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'p'</span>,<span class="st">'r'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       main<span class="op">=</span><span class="st">"connolly.potato"</span>,</span></span>
<span class="r-in"><span>       xlab<span class="op">=</span><span class="st">"Avg yield of nearest neighbors"</span>,</span></span>
<span class="r-in"><span>       ylab<span class="op">=</span><span class="st">"Yield, adjusted for variety and block effects"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="connolly.potato-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

