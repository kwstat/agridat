<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Yield of 9 varieties of lupin at different planting densities across
  2 years and multiple locations."><title>Multi-environment trial of lupin, multiple varieties and densities — verbyla.lupin • agridat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multi-environment trial of lupin, multiple varieties and densities — verbyla.lupin"><meta property="og:description" content="Yield of 9 varieties of lupin at different planting densities across
  2 years and multiple locations."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">agridat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.23</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/agridat_data.html">Additional sources of agricultural data</a>
    <a class="dropdown-item" href="../articles/agridat_graphical_gems.html">Graphical Gems in the agridat Package</a>
    <a class="dropdown-item" href="../articles/agridat_intro.html">Introduction to agridat</a>
    <a class="dropdown-item" href="../articles/agridat_uniformity_data.html">Notes on uniformity data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/kwstat/agridat/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Multi-environment trial of lupin, multiple varieties and densities</h1>
      
      <div class="d-none name"><code>verbyla.lupin.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Yield of 9 varieties of lupin at different planting densities across
  2 years and multiple locations.</p>
    </div>


    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p></p><dl><dt><code>gen</code></dt>
<dd><p>genotype, 9 varieties</p></dd>

    <dt><code>site</code></dt>
<dd><p>site, 11 levels</p></dd>

    <dt><code>rep</code></dt>
<dd><p>rep, 2-3 levels</p></dd>

    <dt><code>rate</code></dt>
<dd><p>seeding rate in plants/m^2</p></dd>

    <dt><code>row</code></dt>
<dd><p>row</p></dd>

    <dt><code>col</code></dt>
<dd><p>column</p></dd>

    <dt><code>serp</code></dt>
<dd><p>factor of 4 levels for serpentine seeding effect</p></dd>

    <dt><code>linrow</code></dt>
<dd><p>centered row position as a numeric variate (row-8.5)/10</p></dd>

    <dt><code>lincol</code></dt>
<dd><p>centered column position as a numeric variate (col-3.5)</p></dd>

    <dt><code>linrate</code></dt>
<dd><p>linear effect of seedrate, scaled (seedrate-41.92958)/10</p></dd>

    <dt><code>yield</code></dt>
<dd><p>yield in tons/hectare</p></dd>

    <dt><code>year</code></dt>
<dd><p>year, 1991-1992</p></dd>

    <dt><code>loc</code></dt>
<dd><p>location</p></dd>

  
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Nine varieties of lupin were tested for yield response to plant density
  at 11 sites.  The target density in 1991 was 10, 20, ..., 60 plants per
  m^2, and in 1992 was 20, 30, ..., 70 plants per m^2.</p>
<p>Plot dimensions are not given.</p>  
<p>The variety Myallie was grown only in 1992.</p>  
<p>Each site had 2 reps in 1991 and 3 reps in
  1992.  Each rep was laid out as a factorial RCB design; one randomization was
  used for all sites in 1991 and one (different) randomization was used
  for all sites in 1992.  (This was confirmed with the principal
  investigator.)</p>  
<p>In 1991 at the Mt. Barker location, the data for columns
  5 and 6 was discarded due to problems with weeds.</p>  
<p>Variety 'Myallie' was called '84L:439' in Verbyla 1997.</p>  
<p>The year of release for the varieties is</p>  
<p></p><table class="table table"><tr><td>Unicrop</td><td>1973</td></tr><tr><td>Illyarrie</td><td>1979</td></tr><tr><td>Yandee</td><td>1980</td></tr><tr><td>Danja</td><td>1986</td></tr><tr><td>Gungurru</td><td>1988</td></tr><tr><td>Yorrel</td><td>1989</td></tr><tr><td>Warrah</td><td>1989</td></tr><tr><td>Merrit</td><td>1991</td></tr><tr><td>Myallie</td><td>1995</td></tr></table><p>Data retrieved Oct 2010 from https://www.blackwellpublishers.co.uk/rss.
  (No longer available).</p>
<p>Used with permission of Blackwell Publishing.</p>
    </div>
    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>Arunas P. Verbyla and Brian R. Cullis and Michael G. Kenward
  and Sue J. Welham, (1999).
  The analysis of designed experiments and longitudinal data by using
  smoothing splines. 
  Appl. Statist., 48, 269--311.
  https://doi.org/10.1111/1467-9876.00154</p>
<p>Arunas P. Verbyla and Brian R. Cullis and Michael G. Kenward
  and Sue J. Welham, (1997).
  The analysis of designed experiments and longitudinal data by using
  smoothing splines.
  University of Adelaide, Department of Statistics, Research Report
  97/4.
  https://https://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.56.808</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kwstat.github.io/agridat/" class="external-link">agridat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">verbyla.lupin</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">verbyla.lupin</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The same RCB randomization was used at all sites in each year</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">desplot</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://kwstat.github.io/desplot/reference/desplot.html" class="external-link">desplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">gen</span><span class="op">~</span><span class="va">col</span><span class="op">+</span><span class="va">row</span><span class="op">|</span><span class="va">site</span>,</span></span>
<span class="r-in"><span>          out1<span class="op">=</span><span class="va">rep</span>, num<span class="op">=</span><span class="va">rate</span>,</span></span>
<span class="r-in"><span>          <span class="co"># aspect unknown</span></span></span>
<span class="r-in"><span>          main<span class="op">=</span><span class="st">"verbyla.lupin - experiment design"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Figure 3 of Verbyla</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">lattice</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">foo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">rate</span><span class="op">|</span><span class="va">loc</span><span class="op">*</span><span class="va">gen</span>, data<span class="op">=</span><span class="va">dat</span>, subset<span class="op">=</span><span class="va">year</span><span class="op">==</span><span class="fl">92</span>,</span></span>
<span class="r-in"><span>                type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'p'</span>,<span class="st">'smooth'</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">.5</span>,</span></span>
<span class="r-in"><span>                main<span class="op">=</span><span class="st">"verbyla.lupin: 1992 yield response curves"</span>,</span></span>
<span class="r-in"><span>                xlab<span class="op">=</span><span class="st">"Seed rate (plants/m^2)"</span>,</span></span>
<span class="r-in"><span>                ylab<span class="op">=</span><span class="st">"Yield (tons/ha)"</span>,</span></span>
<span class="r-in"><span>                strip<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/strip.default.html" class="external-link">strip.custom</a></span><span class="op">(</span>par.strip.text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">.7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">latticeExtra</span><span class="op">)</span> <span class="co"># for useOuterStrips</span></span></span>
<span class="r-in"><span>  <span class="fu">useOuterStrips</span><span class="op">(</span><span class="va">foo</span>,</span></span>
<span class="r-in"><span>                 strip<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/strip.default.html" class="external-link">strip.custom</a></span><span class="op">(</span>par.strip.text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">.7</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 strip.left<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/strip.default.html" class="external-link">strip.custom</a></span><span class="op">(</span>par.strip.text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">.7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># ----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"asreml"</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">asreml</span>,<span class="va">lucid</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># We try to reproduce the analysis of Verbyla 1999.</span></span></span>
<span class="r-in"><span>    <span class="co"># May not be exactly the same, but is pretty close.</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>    <span class="co"># Check nlevels for size of random-coefficient structures</span></span></span>
<span class="r-in"><span>    <span class="co"># length(with(dat, table(gen)))      # 9 varieties for RC1</span></span></span>
<span class="r-in"><span>    <span class="co"># length(with(dat, table(gen,site))) # 99 site:gen combinations for RC2</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># Make row and col into factors</span></span></span>
<span class="r-in"><span>    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat</span>, colf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span>, rowf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">row</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># sort for asreml</span></span></span>
<span class="r-in"><span>    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">site</span>, <span class="va">dat</span><span class="op">$</span><span class="va">rowf</span>, <span class="va">dat</span><span class="op">$</span><span class="va">colf</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># Make site names more useful for plots</span></span></span>
<span class="r-in"><span>    <span class="co"># dat &lt;- transform(dat, site=factor(paste0(year,".",substring(loc,1,4))))</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># Initial model from top of Verbyla table 9.</span></span></span>
<span class="r-in"><span>    <span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu">asreml</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="va">site</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="va">linrate</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="va">site</span><span class="op">:</span><span class="va">linrate</span>,</span></span>
<span class="r-in"><span>                 data <span class="op">=</span> <span class="va">dat</span>,</span></span>
<span class="r-in"><span>                 random <span class="op">=</span> <span class="op">~</span> <span class="fu">spl</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="fu">dev</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="va">site</span><span class="op">:</span><span class="fu">spl</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="va">site</span><span class="op">:</span><span class="fu">dev</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">~</span><span class="va">gen</span><span class="op">+</span><span class="va">gen</span><span class="op">:</span><span class="va">linrate</span>, <span class="op">~</span><span class="fu">us</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">:</span><span class="fu">id</span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="co"># RC1</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="va">gen</span><span class="op">:</span><span class="fu">spl</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="va">gen</span><span class="op">:</span><span class="fu">dev</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">~</span><span class="va">site</span><span class="op">:</span><span class="va">gen</span><span class="op">+</span><span class="va">site</span><span class="op">:</span><span class="va">gen</span><span class="op">:</span><span class="va">linrate</span>, <span class="op">~</span><span class="fu">us</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">:</span><span class="fu">id</span><span class="op">(</span><span class="fl">99</span><span class="op">)</span><span class="op">)</span> <span class="co"># RC2</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="va">site</span><span class="op">:</span><span class="va">gen</span><span class="op">:</span><span class="fu">spl</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="va">site</span><span class="op">:</span><span class="va">gen</span><span class="op">:</span><span class="fu">dev</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 residual <span class="op">=</span> <span class="op">~</span> <span class="fu">dsum</span><span class="op">(</span> <span class="op">~</span> <span class="fu">ar1</span><span class="op">(</span><span class="va">rowf</span><span class="op">)</span><span class="op">:</span><span class="fu">ar1</span><span class="op">(</span><span class="va">colf</span><span class="op">)</span><span class="op">|</span><span class="va">site</span><span class="op">)</span> <span class="co"># Spatial AR1 x AR1</span></span></span>
<span class="r-in"><span>                 <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># Variograms match Verbyla 1999 figure 7 (scale slightly different)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">varioGram</span><span class="op">(</span><span class="va">m0</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span>, zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         main<span class="op">=</span><span class="st">"verbyla.lupin - variogram by site"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># Sequence of models in Verbyla 1999 table 10</span></span></span>
<span class="r-in"><span>    <span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m0</span>, fixed<span class="op">=</span> <span class="op">~</span> <span class="va">.</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">site</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">lincol</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">site</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">linrow</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">site</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">11</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">serp</span></span></span>
<span class="r-in"><span>               , random <span class="op">=</span> <span class="op">~</span> <span class="va">.</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">site</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">rowf</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">site</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">9</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">colf</span></span></span>
<span class="r-in"><span>                 <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">site</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">units</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m1</span>,</span></span>
<span class="r-in"><span>                 random <span class="op">=</span> <span class="op">~</span> <span class="va">.</span></span></span>
<span class="r-in"><span>                 <span class="op">-</span> <span class="va">site</span><span class="op">:</span><span class="va">gen</span><span class="op">:</span><span class="fu">spl</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span> <span class="op">-</span> <span class="va">site</span><span class="op">:</span><span class="va">gen</span><span class="op">:</span><span class="fu">dev</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m2</span>,</span></span>
<span class="r-in"><span>                 random <span class="op">=</span> <span class="op">~</span> <span class="va">.</span></span></span>
<span class="r-in"><span>                 <span class="op">-</span> <span class="va">site</span><span class="op">:</span><span class="fu">dev</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span> <span class="op">-</span> <span class="va">gen</span><span class="op">:</span><span class="fu">dev</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m3</span>,</span></span>
<span class="r-in"><span>                 random <span class="op">=</span> <span class="op">~</span> <span class="va">.</span></span></span>
<span class="r-in"><span>                 <span class="op">-</span> <span class="fu">dev</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="va">m5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">m4</span>,</span></span>
<span class="r-in"><span>                 random <span class="op">=</span> <span class="op">~</span> <span class="va">.</span></span></span>
<span class="r-in"><span>                 <span class="op">-</span> <span class="fu">at</span><span class="op">(</span><span class="va">site</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">units</span> <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">site</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">units</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># Variance components are a pretty good match to Verbyla 1997, table 15</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">lucid</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">vc</span><span class="op">(</span><span class="va">m5</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fl">.001004</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">.005446</span><span class="op">*</span><span class="fl">.0003662</span><span class="op">)</span> <span class="co"># .711 correlation for RC1</span></span></span>
<span class="r-in"><span>    <span class="fl">.00175</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">.01881</span><span class="op">*</span><span class="fl">.000167</span><span class="op">)</span> <span class="co"># .987 correlation for RC2</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># Matches Verbyla 1999 figure 5</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">varioGram</span><span class="op">(</span><span class="va">m5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         main<span class="op">=</span><span class="st">"verbyla.lupin - final model variograms"</span>,</span></span>
<span class="r-in"><span>         xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span>, zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

