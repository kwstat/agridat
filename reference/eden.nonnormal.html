<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Height of barley plants in a study of non-normal data."><title>Height of barley plants in a study of non-normal data — eden.nonnormal • agridat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Height of barley plants in a study of non-normal data — eden.nonnormal"><meta property="og:description" content="Height of barley plants in a study of non-normal data."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">agridat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.23</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/agridat_data.html">Additional sources of agricultural data</a>
    <a class="dropdown-item" href="../articles/agridat_graphical_gems.html">Graphical Gems in the agridat Package</a>
    <a class="dropdown-item" href="../articles/agridat_intro.html">Introduction to agridat</a>
    <a class="dropdown-item" href="../articles/agridat_uniformity_data.html">Notes on uniformity data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/kwstat/agridat/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Height of barley plants in a study of non-normal data</h1>
      
      <div class="d-none name"><code>eden.nonnormal.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Height of barley plants in a study of non-normal data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"eden.nonnormal"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p>A data frame with 256 observations on the following 3 variables.</p><dl><dt><code>pos</code></dt>
<dd><p>position within block</p></dd>

    <dt><code>block</code></dt>
<dd><p>block (numeric)</p></dd>

    <dt><code>height</code></dt>
<dd><p>height of wheat plant</p></dd>

  
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<p>This data was used in a very early example of a permutation test.</p>  
<p>Eden &amp; Yates used this data to consider the impact of non-normal data
  on the validity of a hypothesis test that assumes normality.  They
  concluded that the skew data did not negatively affect the analysis of
  variance.</p>
<p>Grown at Rothamsted. Eight blocks of Yeoman II wheat.  Sampling of the
  blocks was quarter-meter rows, four times in each row.  Rows were
  selected at random. Position  within the rows was partly controlled to
  make use of the whole length of the block.  Plants at both ends of the
  sub-unit were measured. Shoot height is measured from ground level to
  the auricle of the last expanded leaf.</p>
    </div>
    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>T. Eden, F. Yates (1933).
  On the validity of Fisher's z test when applied to an actual example of non-normal data.
  <em>Journal of Agric Science</em>, 23, 6-17.
  https://doi.org/10.1017/S0021859600052862</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kenneth J. Berry, Paul W. Mielke, Jr., Janis E. Johnston
  <em>Permutation Statistical Methods: An Integrated Approach</em>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kwstat.github.io/agridat/" class="external-link">agridat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">eden.nonnormal</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">eden.nonnormal</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">height</span><span class="op">)</span> <span class="co"># 55.23 matches Eden table 1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Eden figure 2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">dplyr</span>, <span class="va">lattice</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Blocks had different means, so substract block mean from each datum</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">dat</span>, <span class="va">block</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">mutate</span><span class="op">(</span><span class="va">dat</span>, blkmn<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">height</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat</span>, dev<span class="op">=</span><span class="va">height</span><span class="op">-</span><span class="va">blkmn</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/histogram.html" class="external-link">histogram</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">dev</span>, data<span class="op">=</span><span class="va">dat</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="op">-</span><span class="fl">40</span>, to<span class="op">=</span><span class="fl">30</span>, by<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          xlab<span class="op">=</span><span class="st">"Deviations from block means"</span>,</span></span>
<span class="r-in"><span>          main<span class="op">=</span><span class="st">"eden.nonnormal - heights skewed left"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># calculate skewness, permutation </span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">dplyr</span>, <span class="va">lattice</span>, <span class="va">latticeExtra</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Eden table 1</span></span></span>
<span class="r-in"><span>  <span class="co"># anova(aov(height ~ factor(block), data=dat))</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Eden table 2,3. Note, this may be a different definition of skewness</span></span></span>
<span class="r-in"><span>  <span class="co"># than is commonly used today (e.g. e1071::skewness).</span></span></span>
<span class="r-in"><span>  <span class="va">skew</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">s1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">s2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">s3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">k3</span><span class="op">=</span><span class="va">n</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">s3</span> <span class="op">-</span><span class="fl">3</span><span class="op">/</span><span class="va">n</span><span class="op">*</span><span class="va">s2</span><span class="op">*</span><span class="va">s1</span> <span class="op">+</span> <span class="fl">2</span><span class="op">/</span><span class="va">n</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">s1</span><span class="op">^</span><span class="fl">3</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">k3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="co"># Negative values indicate data are skewed left</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">dat</span>, <span class="va">block</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">summarize</span><span class="op">(</span><span class="va">dat</span>, s1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">height</span><span class="op">)</span>,s2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">height</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, mean2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">height</span><span class="op">)</span>, k3<span class="op">=</span><span class="fu">skew</span><span class="op">(</span><span class="va">height</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co">##   block     s1       s2     mean2         k3</span></span></span>
<span class="r-in"><span>  <span class="co">##   &lt;int&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span></span></span>
<span class="r-in"><span>  <span class="co">## 1     1 1682.0  95929.5 242.56048 -1268.5210</span></span></span>
<span class="r-in"><span>  <span class="co">## 2     2 1858.0 111661.5 121.97984 -1751.9919</span></span></span>
<span class="r-in"><span>  <span class="co">## 3     3 1809.5 108966.8 214.36064 -3172.5284</span></span></span>
<span class="r-in"><span>  <span class="co">## 4     4 1912.0 121748.5 242.14516 -2548.2194</span></span></span>
<span class="r-in"><span>  <span class="co">## 5     5 1722.0  99026.5 205.20565  -559.0629</span></span></span>
<span class="r-in"><span>  <span class="co">## 6     6 1339.0  63077.0 227.36190  -801.2740</span></span></span>
<span class="r-in"><span>  <span class="co">## 7     7 1963.0 123052.5  84.99093  -713.2595</span></span></span>
<span class="r-in"><span>  <span class="co">## 8     8 1854.0 112366.0 159.67339 -1061.9919</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Another way to view skewness with qq plot. Panel 3 most skewed.</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/qqmath.html" class="external-link">qqmath</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">dev</span><span class="op">|</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">block</span><span class="op">)</span>, data<span class="op">=</span><span class="va">dat</span>,</span></span>
<span class="r-in"><span>         as.table<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>         ylab<span class="op">=</span><span class="st">"Deviations from block means"</span>,</span></span>
<span class="r-in"><span>         panel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.qqmathline.html" class="external-link">panel.qqmathline</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.qqmath.html" class="external-link">panel.qqmath</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></span>
<span class="r-in"><span>         <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Now, permutation test.</span></span></span>
<span class="r-in"><span>  <span class="co"># Eden: "By a process of amalgamation the eight sets of 32 observations were</span></span></span>
<span class="r-in"><span>  <span class="co"># reduced to eight sets of four and the data treated as a potential</span></span></span>
<span class="r-in"><span>  <span class="co"># layout for a 32-plot trial".</span></span></span>
<span class="r-in"><span>  <span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat</span>, grp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, each<span class="op">=</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">grp</span><span class="op">+</span><span class="va">block</span>, <span class="va">dat2</span>, <span class="va">sum</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat2</span><span class="op">$</span><span class="va">trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat2</span><span class="op">$</span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">$</span><span class="va">block</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Treatments were assigned at random 1000 times</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">54323</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">fobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># randomize treatments within each block</span></span></span>
<span class="r-in"><span>    <span class="co"># trick from https://stackoverflow.com/questions/25085537</span></span></span>
<span class="r-in"><span>    <span class="va">dat2</span><span class="op">$</span><span class="va">trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dat2</span>, <span class="fu"><a href="https://rdrr.io/r/stats/ave.html" class="external-link">ave</a></span><span class="op">(</span><span class="va">trt</span>, <span class="va">block</span>, FUN <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">fobs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">block</span> <span class="op">+</span> <span class="va">trt</span>, <span class="va">dat2</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="st">"trt"</span>,<span class="st">"F value"</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># F distribution with 3,21 deg freedom</span></span></span>
<span class="r-in"><span>  <span class="co"># Similar to Eden's figure 4, but on a different horizontal scale</span></span></span>
<span class="r-in"><span>  <span class="va">xval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">0</span>,to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">fobs</span><span class="op">)</span>, length<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">yval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">df</a></span><span class="op">(</span><span class="va">xval</span>, df1 <span class="op">=</span> <span class="fl">3</span>, df2 <span class="op">=</span> <span class="fl">21</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Re-scale, 10 = max of historgram, 0.7 = max of density</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/histogram.html" class="external-link">histogram</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">fobs</span>, breaks<span class="op">=</span><span class="va">xval</span>,</span></span>
<span class="r-in"><span>            xlab<span class="op">=</span><span class="st">"F value"</span>,</span></span>
<span class="r-in"><span>            main<span class="op">=</span><span class="st">"Observed (histogram) &amp; theoretical (line) F values"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="op">(</span><span class="fl">10</span><span class="op">/</span><span class="fl">.7</span><span class="op">)</span><span class="op">*</span> <span class="va">yval</span> <span class="op">~</span> <span class="va">xval</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

