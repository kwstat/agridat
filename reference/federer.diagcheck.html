<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Wheat experiment augmented with two check varieties in diagonal strips."><title>Wheat experiment with diagonal checks — federer.diagcheck • agridat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Wheat experiment with diagonal checks — federer.diagcheck"><meta property="og:description" content="Wheat experiment augmented with two check varieties in diagonal strips."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">agridat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.23</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/agridat_data.html">Additional sources of agricultural data</a>
    <a class="dropdown-item" href="../articles/agridat_graphical_gems.html">Graphical Gems in the agridat Package</a>
    <a class="dropdown-item" href="../articles/agridat_intro.html">Introduction to agridat</a>
    <a class="dropdown-item" href="../articles/agridat_uniformity_data.html">Notes on uniformity data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/kwstat/agridat/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Wheat experiment with diagonal checks</h1>
      
      <div class="d-none name"><code>federer.diagcheck.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Wheat experiment augmented with two check varieties in diagonal strips.</p>
    </div>


    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p>A data frame with 180 observations on the following 4 variables.</p><dl><dt><code>row</code></dt>
<dd><p>row</p></dd>

    <dt><code>col</code></dt>
<dd><p>column</p></dd>

    <dt><code>gen</code></dt>
<dd><p>genotype, 120 levels</p></dd>

    <dt><code>yield</code></dt>
<dd><p>yield</p></dd>

  
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This experiment was conducted by Matthew Reynolds, CIMMYT.  There are
  180 plots in the field, 60 for the diagonal checks (G121 and G122) and
  120 for new varieties.</p>
<p>Federer used this data in multiple papers to illustrate the use of
  orthogonal polynomials to model field trends that are not related to
  the genetic effects.</p>
<p>Note: Federer and Wolfinger (2003) provide a SAS program for analysis
  of this data.  However, when the SAS program is used to analyze this
  data, the results do not match the results given in Federer (1998) nor
  Federer and Wolfinger (2003).  The differences are slight, which
  suggests a typographical error in the presentation of the data.</p>
<p>The R code below provides results that are consistent with the SAS
  code of Federer &amp; Wolfinger (2003) when both are applied to this
  version of the data.</p>
<p>Plot dimensions are not given.</p>
    </div>
    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>Federer, Walter T. 1998. Recovery of interblock, intergradient, and
  intervariety information in incomplete block and lattice rectangle
  design experiments. Biometrics, 54, 471--481.
  https://doi.org/10.2307/3109756</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Walter T Federer and Russell D Wolfinger, 2003.
  Augmented Row-Column Design and Trend Analysis, chapter 28 of
  Handbook of Formulas and Software for Plant Geneticists
    and Breeders, Haworth Press.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kwstat.github.io/agridat/" class="external-link">agridat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">federer.diagcheck</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">federer.diagcheck</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span><span class="op">$</span><span class="va">check</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">gen</span> <span class="op">==</span> <span class="st">"G121"</span> <span class="op">|</span> <span class="va">dat</span><span class="op">$</span><span class="va">gen</span><span class="op">==</span><span class="st">"G122"</span>, <span class="st">"C"</span>,<span class="st">"N"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Show the layout as in Federer 1998.</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">desplot</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://kwstat.github.io/desplot/reference/desplot.html" class="external-link">desplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">yield</span> <span class="op">~</span> <span class="va">col</span><span class="op">*</span><span class="va">row</span>,</span></span>
<span class="r-in"><span>          text<span class="op">=</span><span class="va">gen</span>, show.key<span class="op">=</span><span class="cn">FALSE</span>, <span class="co"># aspect unknown</span></span></span>
<span class="r-in"><span>          shorten<span class="op">=</span><span class="st">'no'</span>, col<span class="op">=</span><span class="va">check</span>, cex<span class="op">=</span><span class="fl">.8</span>, col.text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yellow"</span>,<span class="st">"gray"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          main<span class="op">=</span><span class="st">"federer.diagcheck"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Now reproduce the analysis of Federer 2003.</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Only to match SAS results</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span><span class="op">$</span><span class="va">row</span> <span class="op">&lt;-</span> <span class="fl">16</span> <span class="op">-</span> <span class="va">dat</span><span class="op">$</span><span class="va">row</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">col</span>, <span class="va">dat</span><span class="op">$</span><span class="va">row</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Add row / column polynomials to the data.</span></span></span>
<span class="r-in"><span>  <span class="co"># The scaling factors sqrt() are arbitrary, but used to match SAS</span></span></span>
<span class="r-in"><span>  <span class="va">nr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">row</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">col</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rpoly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">row</span>, degree<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">cpoly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">col</span>, degree<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">nr</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat</span>,</span></span>
<span class="r-in"><span>                   c1 <span class="op">=</span> <span class="va">cpoly</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, c2 <span class="op">=</span> <span class="va">cpoly</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, c3 <span class="op">=</span> <span class="va">cpoly</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                   c4 <span class="op">=</span> <span class="va">cpoly</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span>, c6 <span class="op">=</span> <span class="va">cpoly</span><span class="op">[</span>,<span class="fl">6</span><span class="op">]</span>, c8 <span class="op">=</span> <span class="va">cpoly</span><span class="op">[</span>,<span class="fl">8</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                   r1 <span class="op">=</span> <span class="va">rpoly</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, r2 <span class="op">=</span> <span class="va">rpoly</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, r3 <span class="op">=</span> <span class="va">rpoly</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                   r4 <span class="op">=</span> <span class="va">rpoly</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span>, r8 <span class="op">=</span> <span class="va">rpoly</span><span class="op">[</span>,<span class="fl">8</span><span class="op">]</span>, r10 <span class="op">=</span> <span class="va">rpoly</span><span class="op">[</span>,<span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span><span class="op">$</span><span class="va">trtn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">gen</span> <span class="op">==</span> <span class="st">"G121"</span> <span class="op">|</span> <span class="va">dat</span><span class="op">$</span><span class="va">gen</span><span class="op">==</span><span class="st">"G122"</span>, <span class="va">dat</span><span class="op">$</span><span class="va">gen</span>, <span class="st">"G999"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span><span class="op">$</span><span class="va">new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">gen</span> <span class="op">==</span> <span class="st">"G121"</span> <span class="op">|</span> <span class="va">dat</span><span class="op">$</span><span class="va">gen</span><span class="op">==</span><span class="st">"G122"</span>, <span class="st">"N"</span>, <span class="st">"Y"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat</span>, trtn<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">trtn</span><span class="op">)</span>, new<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">new</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">c1</span> <span class="op">+</span> <span class="va">c2</span> <span class="op">+</span> <span class="va">c3</span> <span class="op">+</span> <span class="va">c4</span> <span class="op">+</span> <span class="va">c6</span> <span class="op">+</span> <span class="va">c8</span></span></span>
<span class="r-in"><span>           <span class="op">+</span> <span class="va">r1</span> <span class="op">+</span> <span class="va">r2</span> <span class="op">+</span> <span class="va">r4</span> <span class="op">+</span> <span class="va">r8</span> <span class="op">+</span> <span class="va">r10</span></span></span>
<span class="r-in"><span>           <span class="op">+</span> <span class="va">c1</span><span class="op">:</span><span class="va">r1</span> <span class="op">+</span> <span class="va">c2</span><span class="op">:</span><span class="va">r1</span> <span class="op">+</span> <span class="va">c3</span><span class="op">:</span><span class="va">r1</span> <span class="op">+</span> <span class="va">gen</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># To get Type III SS use the following</span></span></span>
<span class="r-in"><span>  <span class="co"># libs(car)</span></span></span>
<span class="r-in"><span>  <span class="co"># car::Anova(m1, type=3) # Matches PROC GLM output</span></span></span>
<span class="r-in"><span>  <span class="co">##                Sum Sq  Df  F value    Pr(&gt;F)    </span></span></span>
<span class="r-in"><span>  <span class="co">## (Intercept)  538948   1 159.5804 3.103e-16 ***</span></span></span>
<span class="r-in"><span>  <span class="co">## c1            13781   1   4.0806 0.0494940 *  </span></span></span>
<span class="r-in"><span>  <span class="co">## c2            51102   1  15.1312 0.0003354 ***</span></span></span>
<span class="r-in"><span>  <span class="co">## c3            45735   1  13.5419 0.0006332 ***</span></span></span>
<span class="r-in"><span>  <span class="co">## c4            24670   1   7.3048 0.0097349 ** </span></span></span>
<span class="r-in"><span>  <span class="co">## ...</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># lmer</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">lme4</span>,<span class="va">lucid</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># "group" for all data</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span><span class="op">$</span><span class="va">one</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># lmer with bobyqa (default)</span></span></span>
<span class="r-in"><span>  <span class="va">m2b</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">trtn</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">r1</span> <span class="op">+</span> <span class="va">r2</span> <span class="op">+</span> <span class="va">r4</span> <span class="op">+</span> <span class="va">r8</span> <span class="op">+</span> <span class="va">r10</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                <span class="va">c1</span> <span class="op">+</span> <span class="va">c2</span> <span class="op">+</span> <span class="va">c3</span> <span class="op">+</span> <span class="va">c4</span> <span class="op">+</span> <span class="va">c6</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                <span class="va">c8</span> <span class="op">+</span> <span class="va">r1</span><span class="op">:</span><span class="va">c1</span> <span class="op">+</span> <span class="va">r1</span><span class="op">:</span><span class="va">c2</span> <span class="op">+</span> <span class="va">r1</span><span class="op">:</span><span class="va">c3</span> <span class="op">||</span> <span class="va">one</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">new</span><span class="op">:</span><span class="va">gen</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              data <span class="op">=</span> <span class="va">dat</span>,</span></span>
<span class="r-in"><span>              control<span class="op">=</span><span class="fu">lmerControl</span><span class="op">(</span>check.nlev.gtr.1<span class="op">=</span><span class="st">"ignore"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">vc</span><span class="op">(</span><span class="va">m2b</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co">##      grp        var1 var2     vcov  sdcor</span></span></span>
<span class="r-in"><span>  <span class="co">##  new.gen (Intercept) &lt;NA&gt;   2869    53.57</span></span></span>
<span class="r-in"><span>  <span class="co">##      one       r1:c3 &lt;NA&gt;   5532    74.37</span></span></span>
<span class="r-in"><span>  <span class="co">##    one.1       r1:c2 &lt;NA&gt;  58230   241.3</span></span></span>
<span class="r-in"><span>  <span class="co">##    one.2       r1:c1 &lt;NA&gt; 128000   357.8</span></span></span>
<span class="r-in"><span>  <span class="co">##    one.3          c8 &lt;NA&gt;   6456    80.35</span></span></span>
<span class="r-in"><span>  <span class="co">##    one.4          c6 &lt;NA&gt;   1400    37.41</span></span></span>
<span class="r-in"><span>  <span class="co">##    one.5          c4 &lt;NA&gt;   1792    42.33</span></span></span>
<span class="r-in"><span>  <span class="co">##    one.6          c3 &lt;NA&gt;   2549    50.49</span></span></span>
<span class="r-in"><span>  <span class="co">##    one.7          c2 &lt;NA&gt;   5942    77.08</span></span></span>
<span class="r-in"><span>  <span class="co">##    one.8          c1 &lt;NA&gt;      0     0</span></span></span>
<span class="r-in"><span>  <span class="co">##    one.9         r10 &lt;NA&gt;   1133    33.66</span></span></span>
<span class="r-in"><span>  <span class="co">##   one.10          r8 &lt;NA&gt;   1355    36.81</span></span></span>
<span class="r-in"><span>  <span class="co">##   one.11          r4 &lt;NA&gt;   2269    47.63</span></span></span>
<span class="r-in"><span>  <span class="co">##   one.12          r2 &lt;NA&gt;    241.8  15.55</span></span></span>
<span class="r-in"><span>  <span class="co">##   one.13          r1 &lt;NA&gt;   9200    95.92</span></span></span>
<span class="r-in"><span>  <span class="co">## Residual        &lt;NA&gt; &lt;NA&gt;   4412    66.42</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># lmer with Nelder_Mead gives 'wrong' results</span></span></span>
<span class="r-in"><span>  <span class="co">## m2n &lt;- lmer(yield ~ trtn + (0 + r1 + r2 + r4 + r8 + r10 +</span></span></span>
<span class="r-in"><span>  <span class="co">##             c1 + c2 + c3 + c4 + c6 + c8 + r1:c1 + r1:c2 + r1:c3 || one) +</span></span></span>
<span class="r-in"><span>  <span class="co">##             (1|new:gen)</span></span></span>
<span class="r-in"><span>  <span class="co">##             , data = dat,</span></span></span>
<span class="r-in"><span>  <span class="co">##             control=lmerControl(optimizer="Nelder_Mead",</span></span></span>
<span class="r-in"><span>  <span class="co">##                                 check.nlev.gtr.1="ignore"))</span></span></span>
<span class="r-in"><span>  <span class="co">## vc(m2n)</span></span></span>
<span class="r-in"><span>  <span class="co">##    groups        name variance   stddev</span></span></span>
<span class="r-in"><span>  <span class="co">##  new.gen  (Intercept)   3228    56.82</span></span></span>
<span class="r-in"><span>  <span class="co">##  one      r1:c3         7688    87.68</span></span></span>
<span class="r-in"><span>  <span class="co">##  one.1    r1:c2        69750   264.1</span></span></span>
<span class="r-in"><span>  <span class="co">##  one.2    r1:c1       107400   327.8</span></span></span>
<span class="r-in"><span>  <span class="co">##  one.3    c8            6787    82.38</span></span></span>
<span class="r-in"><span>  <span class="co">##  one.4    c6            1636    40.45</span></span></span>
<span class="r-in"><span>  <span class="co">##  one.5    c4           12270   110.8</span></span></span>
<span class="r-in"><span>  <span class="co">##  one.6    c3            2686    51.83</span></span></span>
<span class="r-in"><span>  <span class="co">##  one.7    c2            7645    87.43</span></span></span>
<span class="r-in"><span>  <span class="co">##  one.8    c1               0     0.0351</span></span></span>
<span class="r-in"><span>  <span class="co">##  one.9    r10           1976    44.45</span></span></span>
<span class="r-in"><span>  <span class="co">##  one.10   r8            1241    35.23</span></span></span>
<span class="r-in"><span>  <span class="co">##  one.11   r4            2811    53.02</span></span></span>
<span class="r-in"><span>  <span class="co">##  one.12   r2             928.2  30.47</span></span></span>
<span class="r-in"><span>  <span class="co">##  one.13   r1           10360   101.8</span></span></span>
<span class="r-in"><span>  <span class="co">##  Residual               4127    64.24</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"asreml"</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">asreml</span>,<span class="va">lucid</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu">asreml</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">trtn</span>, data<span class="op">=</span><span class="va">dat</span>,</span></span>
<span class="r-in"><span>                 random <span class="op">=</span> <span class="op">~</span> <span class="va">r1</span> <span class="op">+</span> <span class="va">r2</span> <span class="op">+</span> <span class="va">r4</span> <span class="op">+</span> <span class="va">r8</span> <span class="op">+</span> <span class="va">r10</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                   <span class="va">c1</span> <span class="op">+</span> <span class="va">c2</span> <span class="op">+</span> <span class="va">c3</span> <span class="op">+</span> <span class="va">c4</span> <span class="op">+</span> <span class="va">c6</span> <span class="op">+</span> <span class="va">c8</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                   <span class="va">r1</span><span class="op">:</span><span class="va">c1</span> <span class="op">+</span> <span class="va">r1</span><span class="op">:</span><span class="va">c2</span> <span class="op">+</span> <span class="va">r1</span><span class="op">:</span><span class="va">c3</span> <span class="op">+</span> <span class="va">new</span><span class="op">:</span><span class="va">gen</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">## coef(m3)</span></span></span>
<span class="r-in"><span>    <span class="co">## # REML cultivar means.  Very similar to Federer table 2.</span></span></span>
<span class="r-in"><span>    <span class="co">## rev(sort(round(coef(m3)$fixed[3] + coef(m3)$random[137:256,],0)))</span></span></span>
<span class="r-in"><span>    <span class="co">## ## gen_G060 gen_G021 gen_G011 gen_G099 gen_G002</span></span></span>
<span class="r-in"><span>    <span class="co">## ##      974      949      945      944      942</span></span></span>
<span class="r-in"><span>    <span class="co">## ## gen_G118 gen_G058 gen_G035 gen_G111 gen_G120</span></span></span>
<span class="r-in"><span>    <span class="co">## ##      938      937      937      933      932</span></span></span>
<span class="r-in"><span>    <span class="co">## ## gen_G046 gen_G061 gen_G082 gen_G038 gen_G090</span></span></span>
<span class="r-in"><span>    <span class="co">## ##      932      931      927      927      926</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co">## vc(m3)</span></span></span>
<span class="r-in"><span>    <span class="co">## ##           effect component std.error z.ratio constr</span></span></span>
<span class="r-in"><span>    <span class="co">## ##        r1!r1.var   9201        13720    0.67    pos</span></span></span>
<span class="r-in"><span>    <span class="co">## ##        r2!r2.var    241.7       1059    0.23    pos</span></span></span>
<span class="r-in"><span>    <span class="co">## ##        r4!r4.var   2269         3915    0.58    pos</span></span></span>
<span class="r-in"><span>    <span class="co">## ##        r8!r8.var   1355         2627    0.52    pos</span></span></span>
<span class="r-in"><span>    <span class="co">## ##      r10!r10.var   1133         2312    0.49    pos</span></span></span>
<span class="r-in"><span>    <span class="co">## ##        c1!c1.var      0.01         0    4.8   bound</span></span></span>
<span class="r-in"><span>    <span class="co">## ##        c2!c2.var   5942         8969    0.66    pos</span></span></span>
<span class="r-in"><span>    <span class="co">## ##        c3!c3.var   2549         4177    0.61    pos</span></span></span>
<span class="r-in"><span>    <span class="co">## ##        c4!c4.var   1792         3106    0.58    pos</span></span></span>
<span class="r-in"><span>    <span class="co">## ##        c6!c6.var   1400         2551    0.55    pos</span></span></span>
<span class="r-in"><span>    <span class="co">## ##        c8!c8.var   6456         9702    0.67    pos</span></span></span>
<span class="r-in"><span>    <span class="co">## ##     r1:c1!r1.var 128000       189700    0.67    pos</span></span></span>
<span class="r-in"><span>    <span class="co">## ##     r1:c2!r1.var  58230        90820    0.64    pos</span></span></span>
<span class="r-in"><span>    <span class="co">## ##     r1:c3!r1.var   5531        16550    0.33    pos</span></span></span>
<span class="r-in"><span>    <span class="co">## ##  new:gen!new.var   2869         1367    2.1     pos</span></span></span>
<span class="r-in"><span>    <span class="co">## ##       R!variance   4412          915    4.8     pos</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

