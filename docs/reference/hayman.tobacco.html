<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Diallel cross of Aztec tobacco in 2 reps"><title>Diallel cross of Aztec tobacco — hayman.tobacco • agridat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Diallel cross of Aztec tobacco — hayman.tobacco"><meta property="og:description" content="Diallel cross of Aztec tobacco in 2 reps"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">agridat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.23</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/agridat_data.html">Additional sources of agricultural data</a>
    <a class="dropdown-item" href="../articles/agridat_graphical_gems.html">Graphical Gems in the agridat Package</a>
    <a class="dropdown-item" href="../articles/agridat_intro.html">Introduction to agridat</a>
    <a class="dropdown-item" href="../articles/agridat_uniformity_data.html">Notes on uniformity data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/kwstat/agridat/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Diallel cross of Aztec tobacco</h1>
      
      <div class="d-none name"><code>hayman.tobacco.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Diallel cross of Aztec tobacco in 2 reps</p>
    </div>


    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    

<p></p><dl><dt><code>year</code></dt>
<dd><p>year</p></dd>

    <dt><code>block</code></dt>
<dd><p>block factor, 2 levels</p></dd>

    <dt><code>male</code></dt>
<dd><p>male parent, 8 levels</p></dd>

    <dt><code>female</code></dt>
<dd><p>female parent</p></dd>

    <dt><code>day</code></dt>
<dd><p>mean flowering time (days)</p></dd>

  
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    
  
<p>Data was collected in 1951 (Hayman 1954a) and 1952 (Hayman 1954b).</p>
<p>In each year there were 8 varieties of Aztec tobacco, <em>Nicotiana rustica L.</em>.</p>
<p>Each cross/self was represented by 10 progeny, in two plots of 5
  plants each.  The data are the mean flowering time per plot.</p>
<p>Note, the 1951 data as published in Hayman (1954a) Table 5 contain
  "10 times the mean flowering time".  The data here have been divided
  by 10 so as to be comparable with the 1952 data.</p>
<p>Hayman (1954b) says "Table 2 lists...three characters from a diallel
  cross of Nicotiana rustica varieties which was repeated for three years."
  This seems to indicate that the varieties are the same in 1951 and
  1952.  Calculating the GCA effects separately for 1951 and 1952 and
  then comparing these estimates shows that they are highly correlated.</p>
    </div>
    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    

<p>B. I. Hayman (1954a). The Analysis of Variance of Diallel Tables.
  Biometrics, 10, 235-244.  Table 5, page 241.
  https://doi.org/10.2307/3001877</p>
<p>Hayman, B.I. (1954b). The theory and analysis of diallel crosses.
  <em>Genetics</em>, 39, 789-809.  Table 3, page 805.
  https://www.genetics.org/content/39/6/789.full.pdf</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    

<p># For 1951 data</p>
<p>Mohring, Melchinger, Piepho. (2011).
  REML-Based Diallel Analysis.
  Crop Science, 51, 470-478.</p>
<p># For 1952 data</p>
<p>C. Clark Cockerham and B. S. Weir. (1977).
  Quadratic analyses of reciprocal crosses.
  Biometrics, 33, 187-203.  Appendix C.</p>
<p>Andrea Onofri, Niccolo Terzaroli, Luigi Russi (2020).
  Linear models for diallel crosses: A review with R functions.
  Theoretical and Applied Genetics.
  https://doi.org/10.1007/s00122-020-03716-8</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kwstat.github.io/agridat/" class="external-link">agridat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># 1951 data.  Fit the first REML model of Mohring 2011 Supplement.  </span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">hayman.tobacco</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">hayman.tobacco</span>, <span class="va">year</span><span class="op">==</span><span class="fl">1951</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Hayman's model</span></span></span>
<span class="r-in"><span>  <span class="co"># dat1 &lt;- subset(hayman.tobacco, year==1951)</span></span></span>
<span class="r-in"><span>  <span class="co"># libs(lmDiallel)</span></span></span>
<span class="r-in"><span>  <span class="co"># m1  &lt;- lm.diallel(day ~ male+female, Block=block, data=dat1, fct="HAYMAN2")</span></span></span>
<span class="r-in"><span>  <span class="co"># anova(m1) # Similar to table 7 of Hayman 1954a</span></span></span>
<span class="r-in"><span>  <span class="co">## Response: day</span></span></span>
<span class="r-in"><span>  <span class="co">##                Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span></span>
<span class="r-in"><span>  <span class="co">## Block           1    1.42    1.42  0.3416   0.56100    </span></span></span>
<span class="r-in"><span>  <span class="co">## Mean Dom. Dev.  1  307.97  307.97 73.8840 3.259e-12 ***</span></span></span>
<span class="r-in"><span>  <span class="co">## GCA             7 2777.17  396.74 95.1805 &lt; 2.2e-16 ***</span></span></span>
<span class="r-in"><span>  <span class="co">## Dom. Dev.       7  341.53   48.79 11.7050 1.957e-09 ***</span></span></span>
<span class="r-in"><span>  <span class="co">## SCA            20  372.89   18.64  4.4729 2.560e-06 ***</span></span></span>
<span class="r-in"><span>  <span class="co">## RGCA            7   67.39    9.63  2.3097   0.03671 *  </span></span></span>
<span class="r-in"><span>  <span class="co">## RSCA           21  123.73    5.89  1.4135   0.14668    </span></span></span>
<span class="r-in"><span>  <span class="co">## Residuals      63  262.60                              </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Griffing's model</span></span></span>
<span class="r-in"><span>  <span class="co"># https://www.statforbiology.com/2021/stat_met_diallel_griffing/</span></span></span>
<span class="r-in"><span>  <span class="co"># dat1 &lt;- subset(hayman.tobacco, year==1951)</span></span></span>
<span class="r-in"><span>  <span class="co"># libs(lmDiallel)</span></span></span>
<span class="r-in"><span>  <span class="co"># contrasts(dat1$block) &lt;- "contr.sum"</span></span></span>
<span class="r-in"><span>  <span class="co"># dmod1 and dmod2 are the same model with different syntax</span></span></span>
<span class="r-in"><span>  <span class="co"># dmod1 &lt;- lm(day ~ block + GCA(male, female) + tSCA(male, female) +</span></span></span>
<span class="r-in"><span>  <span class="co">#               REC(male, female) , data = dat1)</span></span></span>
<span class="r-in"><span>  <span class="co"># dmod2 &lt;- lm.diallel(day ~ male + female, Block=block, </span></span></span>
<span class="r-in"><span>  <span class="co">#                     data = dat1, fct = "GRIFFING1")</span></span></span>
<span class="r-in"><span>  <span class="co"># anova(dmod1)</span></span></span>
<span class="r-in"><span>  <span class="co"># anova(dmod2)</span></span></span>
<span class="r-in"><span>  <span class="co">## Response: day</span></span></span>
<span class="r-in"><span>  <span class="co">##             Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span></span>
<span class="r-in"><span>  <span class="co">## Block        1    1.42    1.42  0.3416   0.56100    </span></span></span>
<span class="r-in"><span>  <span class="co">## GCA          7 2777.17  396.74 95.1805 &lt; 2.2e-16 ***</span></span></span>
<span class="r-in"><span>  <span class="co">## SCA         28 1022.38   36.51  8.7599 6.656e-13 ***</span></span></span>
<span class="r-in"><span>  <span class="co">## Reciprocals 28  191.12    6.83  1.6375   0.05369 .  </span></span></span>
<span class="r-in"><span>  <span class="co">## Residuals   63  262.60                              </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Make a factor 'comb' in which G1xG2 is the same cross as G2xG1</span></span></span>
<span class="r-in"><span>  <span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat1</span>,</span></span>
<span class="r-in"><span>                    comb <span class="op">=</span></span></span>
<span class="r-in"><span>                      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">male</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">female</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                             <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">male</span>,<span class="va">female</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">female</span>,<span class="va">male</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># 'dr' is the direction of the cross, 0 for self</span></span></span>
<span class="r-in"><span>  <span class="va">dat1</span><span class="op">$</span><span class="va">dr</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat1</span>,</span></span>
<span class="r-in"><span>                    dr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">male</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">female</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span>, <span class="va">dr</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat1</span>,</span></span>
<span class="r-in"><span>                    dr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">male</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">female</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">dr</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># asreml r version 3 &amp; 4 code for Mixed Griffing.</span></span></span>
<span class="r-in"><span>  <span class="co"># Mohring Table 2, column 2 (after dividing by 10^2) gives variances:</span></span></span>
<span class="r-in"><span>  <span class="co"># GCA 12.77, SCA 11.09, RSCA .65, Error 4.23.</span></span></span>
<span class="r-in"><span>  <span class="co"># Mohring Supplement ASREML code part1 model is:</span></span></span>
<span class="r-in"><span>  <span class="co"># y ~ mu r !r mother and(father) combination combination.dr</span></span></span>
<span class="r-in"><span>  <span class="co"># Note that the levels of 'male' and 'female' are the same, so the</span></span></span>
<span class="r-in"><span>  <span class="co"># and(female) term tells asreml to use the same levels (or, equivalently,</span></span></span>
<span class="r-in"><span>  <span class="co"># fix the correlation of the male/female levels to be 1.</span></span></span>
<span class="r-in"><span>  <span class="co"># The block effect is minimial and therefore ignored.</span></span></span>
<span class="r-in"><span>  <span class="co">## libs(asreml, lucid)</span></span></span>
<span class="r-in"><span>  <span class="co">## m1 &lt;- asreml(day~1, data=dat1,</span></span></span>
<span class="r-in"><span>  <span class="co">##              random = ~ male + and(female) + comb + comb:dr)</span></span></span>
<span class="r-in"><span>  <span class="co">## vc(m1)</span></span></span>
<span class="r-in"><span>  <span class="co">##           effect component std.error z.ratio      con</span></span></span>
<span class="r-in"><span>  <span class="co">##    male!male.var   12.77      7.502      1.7 Positive</span></span></span>
<span class="r-in"><span>  <span class="co">##    comb!comb.var   11.11      3.353      3.3 Positive</span></span></span>
<span class="r-in"><span>  <span class="co">## comb:dr!comb.var    0.6603    0.4926     1.3 Positive</span></span></span>
<span class="r-in"><span>  <span class="co">##       R!variance    4.185     0.7449     5.6 Positive</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># ----------</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># 1952 data. Reproduce table 3 and figure 2 of Hayman 1954b.</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">hayman.tobacco</span>, <span class="va">year</span><span class="op">==</span><span class="fl">1952</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Does flowering date follow a gamma distn?  Maybe.</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">lattice</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/histogram.html" class="external-link">densityplot</a></span><span class="op">(</span><span class="op">~</span><span class="va">day</span>, data<span class="op">=</span><span class="va">dat2</span>, main<span class="op">=</span><span class="st">"hayman.tobacco"</span>,</span></span>
<span class="r-in"><span>              xlab<span class="op">=</span><span class="st">"flowering date"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat2</span>, <span class="va">block</span><span class="op">==</span><span class="st">'B1'</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat2</span>, <span class="va">block</span><span class="op">==</span><span class="st">'B2'</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">reshape2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">acast</span><span class="op">(</span><span class="va">d1</span>, <span class="va">male</span><span class="op">~</span><span class="va">female</span>, value.var<span class="op">=</span><span class="st">'day'</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">acast</span><span class="op">(</span><span class="va">d2</span>, <span class="va">male</span><span class="op">~</span><span class="va">female</span>, value.var<span class="op">=</span><span class="st">'day'</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">mn1</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">m1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="va">mn2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">m2</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Variance and covariance of 'rth' offspring</span></span></span>
<span class="r-in"><span>  <span class="va">vr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mn1</span>, <span class="fl">1</span>, <span class="va">var</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">vr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mn2</span>, <span class="fl">1</span>, <span class="va">var</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">wr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mn1</span>, <span class="fl">1</span>, <span class="va">cov</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">mn1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">wr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mn2</span>, <span class="fl">1</span>, <span class="va">cov</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">mn2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Remove row names to prevent a mild warning</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mn1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mn2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span>  <span class="va">summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mn1</span>,<span class="va">mn2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">summ</span><span class="op">$</span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'B1'</span>,<span class="st">'B2'</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">summ</span><span class="op">$</span><span class="va">vr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vr1</span>,<span class="va">vr2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">summ</span><span class="op">$</span><span class="va">wr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">wr1</span>,<span class="va">wr2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">summ</span><span class="op">$</span><span class="va">male</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">)</span> <span class="co"># Vr and Wr match Hayman table 3</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">summ</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wr</span><span class="op">~</span><span class="va">vr</span>, type<span class="op">=</span><span class="st">'n'</span>, main<span class="op">=</span><span class="st">"hayman.tobacco"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">summ</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">vr</span>, <span class="va">wr</span>, <span class="va">male</span><span class="op">)</span><span class="op">)</span> <span class="co"># Match Hayman figure 2</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,col<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Hayman notes that 1 and 3 do not lie along the line,</span></span></span>
<span class="r-in"><span>  <span class="co"># so modifies them and re-analyzes.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

