<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="For the 34 sheep sires, the number of lambs in each of 5 foot shape classes."><title>For the 34 sheep sires, the number of lambs in each of 5 foot shape classes. — alwan.lamb • agridat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="For the 34 sheep sires, the number of lambs in each of 5 foot shape classes. — alwan.lamb"><meta property="og:description" content="For the 34 sheep sires, the number of lambs in each of 5 foot shape classes."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">agridat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.23</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/agridat_data.html">Additional sources of agricultural data</a>
    <a class="dropdown-item" href="../articles/agridat_graphical_gems.html">Graphical Gems in the agridat Package</a>
    <a class="dropdown-item" href="../articles/agridat_intro.html">Introduction to agridat</a>
    <a class="dropdown-item" href="../articles/agridat_uniformity_data.html">Notes on uniformity data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/kwstat/agridat/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>For the 34 sheep sires, the number of lambs in each of 5 foot shape classes.</h1>
      
      <div class="d-none name"><code>alwan.lamb.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For the 34 sheep sires, the number of lambs in each of 5 foot shape classes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"alwan.lamb"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p>A data frame with 340 observations on the following 11 variables.</p><dl><dt><code>year</code></dt>
<dd><p>numeric 1980/1981</p></dd>

    <dt><code>breed</code></dt>
<dd><p>breed PP, BRP, BR</p></dd>

    <dt><code>sex</code></dt>
<dd><p>sex of lamb M/F</p></dd>

    <dt><code>sire0</code></dt>
<dd><p>sire ID according to Alwan</p></dd>

    <dt><code>shape</code></dt>
<dd><p>sire ID according to Gilmour</p></dd>

    <dt><code>count</code></dt>
<dd><p>number of lambs</p></dd>

    <dt><code>sire</code></dt>
<dd><p>shape of foot</p></dd>

    <dt><code>yr</code></dt>
<dd><p>numeric contrast for year</p></dd>

    <dt><code>b1</code></dt>
<dd><p>numeric contrast for breeds</p></dd>

    <dt><code>b2</code></dt>
<dd><p>numeric contrast for breeds</p></dd>

    <dt><code>b3</code></dt>
<dd><p>numeric contrast for breeds</p></dd>

  
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>There were 2513 lambs classified on the presence of deformities in
  their feet.  The lambs represent the offspring of 34 sires, 5 strains,
  2 years.</p>
<p>The variables yr, b1, b2, b3 are numeric contrasts for the fixed
  effects as defined in the paper by Gilmour (1987) and used in the SAS
  example. Gilmour does not explain the reason for the particular
  contrasts. The counts for classes LF1, LF2, LF3 were combined.</p>
    </div>
    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>Mohammed Alwan (1983).
  Studies of the flock mating performance of Booroola merino crossbred ram lambs, and the foot conditions in Booroola merino crossbreds and Perendale sheep grazed on hill country.
  Thesis, Massey University. https://hdl.handle.net/10179/5900
  Appendix I, II.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gilmour, Anderson, and Rae (1987).
  Variance components on an underlying scale for ordered multiple threshold categorical data using a generalized linear mixed model.
  Journal of Animal Breeding and Genetics, 104, 149-155.
  https://doi.org/10.1111/j.1439-0388.1987.tb00117.x</p>
<p>SAS/STAT(R) 9.2 Users Guide, Second Edition
  Example 38.11 Maximum Likelihood in Proportional Odds Model with Random Effects
  https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kwstat.github.io/agridat/" class="external-link">agridat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">alwan.lamb</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">alwan.lamb</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># merge LF1 LF2 LF3 class counts, and combine M/F</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span><span class="op">$</span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">shape</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span><span class="op">$</span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">shape</span><span class="op">==</span><span class="st">"LF2"</span>, <span class="st">"LF3"</span>, <span class="va">dat</span><span class="op">$</span><span class="va">shape</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span><span class="op">$</span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">shape</span><span class="op">==</span><span class="st">"LF1"</span>, <span class="st">"LF3"</span>, <span class="va">dat</span><span class="op">$</span><span class="va">shape</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">year</span><span class="op">+</span><span class="va">breed</span><span class="op">+</span><span class="va">sire0</span><span class="op">+</span><span class="va">sire</span><span class="op">+</span><span class="va">shape</span><span class="op">+</span><span class="va">yr</span><span class="op">+</span><span class="va">b1</span><span class="op">+</span><span class="va">b2</span><span class="op">+</span><span class="va">b3</span>,</span></span>
<span class="r-in"><span>                   <span class="va">dat</span>, FUN<span class="op">=</span><span class="va">sum</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat</span>,</span></span>
<span class="r-in"><span>                   year<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span>, breed<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">breed</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   sire0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sire0</span><span class="op">)</span>, sire<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sire</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># LF5 or LF3 first is a bit arbitary...affects the sign of the coefficients</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">dat</span>, shape<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">shape</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LF5"</span>,<span class="st">"LF4"</span>,<span class="st">"LF3"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># View counts by year and breed</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">latticeExtra</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">year</span><span class="op">+</span><span class="va">breed</span><span class="op">+</span><span class="va">shape</span>, <span class="va">dat</span>, FUN<span class="op">=</span><span class="va">sum</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">useOuterStrips</span><span class="op">(</span><span class="fu">barchart</span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">shape</span><span class="op">|</span><span class="va">year</span><span class="op">*</span><span class="va">breed</span>, data<span class="op">=</span><span class="va">dat2</span>,</span></span>
<span class="r-in"><span>                          main<span class="op">=</span><span class="st">"alwan.lamb"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Model used by Gilmour and SAS</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">count</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="libs.html">libs</a></span><span class="op">(</span><span class="va">ordinal</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">clmm</span><span class="op">(</span><span class="va">shape</span> <span class="op">~</span> <span class="va">yr</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">+</span> <span class="va">b2</span> <span class="op">+</span> <span class="va">b3</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">sire</span><span class="op">)</span>, data<span class="op">=</span><span class="va">dat</span>,</span></span>
<span class="r-in"><span>             weights<span class="op">=</span><span class="va">count</span>, link<span class="op">=</span><span class="st">"probit"</span>, Hess<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="co"># Very similar to Gilmour results</span></span></span>
<span class="r-in"><span>  <span class="fu">ordinal</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html" class="external-link">ranef</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="co"># sign is opposite of SAS</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## SAS var of sires .04849</span></span></span>
<span class="r-in"><span>  <span class="co">## Effect   Shape   Estimate   Standard Error   DF   t Value   Pr &gt; |t|</span></span></span>
<span class="r-in"><span>  <span class="co">## Intercept   1   0.3781   0.04907   29   7.71   &lt;.0001</span></span></span>
<span class="r-in"><span>  <span class="co">## Intercept   2   1.6435   0.05930   29   27.72   &lt;.0001</span></span></span>
<span class="r-in"><span>  <span class="co">## yr       0.1422   0.04834   2478   2.94   0.0033</span></span></span>
<span class="r-in"><span>  <span class="co">## b1       0.3781   0.07154   2478   5.28   &lt;.0001</span></span></span>
<span class="r-in"><span>  <span class="co">## b2       0.3157   0.09709   2478   3.25   0.0012</span></span></span>
<span class="r-in"><span>  <span class="co">## b3       -0.09887   0.06508   2478   -1.52   0.1289</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">## Gilmour results for probit analysis</span></span></span>
<span class="r-in"><span>  <span class="co">## Int1   .370 +/- .052</span></span></span>
<span class="r-in"><span>  <span class="co">## Int2  1.603 +/- .061</span></span></span>
<span class="r-in"><span>  <span class="co">## Year  -.139 +/- .052</span></span></span>
<span class="r-in"><span>  <span class="co">## B1    -.370 +/- .076</span></span></span>
<span class="r-in"><span>  <span class="co">## B2    -.304 +/- .103</span></span></span>
<span class="r-in"><span>  <span class="co">## B3     .098 +/- .070</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Plot random sire effects with intervals, similar to SAS example</span></span></span>
<span class="r-in"><span>  <span class="va">plot.random</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">random.effect</span>, <span class="va">ylim</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">xlab</span><span class="op">=</span><span class="st">""</span>, <span class="va">main</span><span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu">ordinal</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/random.effects.html" class="external-link">ranef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[[</span><span class="va">random.effect</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span>, est<span class="op">=</span><span class="va">tab</span><span class="op">$</span><span class="st">"(Intercept)"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">tab</span>,</span></span>
<span class="r-in"><span>                     lo <span class="op">=</span> <span class="va">est</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">condVar</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     hi <span class="op">=</span> <span class="va">est</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">condVar</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># sort by est, and return index</span></span></span>
<span class="r-in"><span>    <span class="va">ix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">tab</span><span class="op">$</span><span class="va">est</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">tab</span> <span class="op">&lt;-</span> <span class="va">tab</span><span class="op">[</span><span class="va">ix</span>,<span class="op">]</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">ylim</span><span class="op">)</span><span class="op">)</span> <span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tab</span><span class="op">$</span><span class="va">lo</span>, <span class="va">tab</span><span class="op">$</span><span class="va">hi</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="va">tab</span><span class="op">$</span><span class="va">est</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, ylim<span class="op">=</span><span class="va">ylim</span>, xlab<span class="op">=</span><span class="va">xlab</span>,</span></span>
<span class="r-in"><span>         ylab<span class="op">=</span><span class="st">"effect"</span>, main<span class="op">=</span><span class="va">main</span>, type<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="va">tab</span><span class="op">$</span><span class="va">est</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">tab</span><span class="op">$</span><span class="va">lab</span>,<span class="fl">2</span><span class="op">)</span> , cex<span class="op">=</span><span class="fl">.75</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="va">tab</span><span class="op">$</span><span class="va">lo</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="va">tab</span><span class="op">$</span><span class="va">hi</span>, col<span class="op">=</span><span class="st">"gray30"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.5</span>, <span class="op">-</span><span class="fl">.25</span>, <span class="fl">0</span>, <span class="fl">.25</span>, <span class="fl">.5</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">ix</span><span class="op">)</span>  </span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="va">ix</span> <span class="op">&lt;-</span> <span class="fu">plot.random</span><span class="op">(</span><span class="va">m1</span>, <span class="st">"sire"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># foot-shape proportions for each sire, sorted by estimated sire effects</span></span></span>
<span class="r-in"><span>  <span class="co"># positive sire effects tend to have lower proportion of lambs in LF4 and LF5</span></span></span>
<span class="r-in"><span>  <span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">sire</span><span class="op">+</span><span class="va">shape</span>, <span class="va">dat</span><span class="op">)</span>, margin<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">tab</span> <span class="op">&lt;-</span> <span class="va">tab</span><span class="op">[</span><span class="va">ix</span>,<span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">tab</span> <span class="op">&lt;-</span> <span class="va">tab</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span>,<span class="op">]</span> <span class="co"># reverse the order</span></span></span>
<span class="r-in"><span>  <span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">barchart</a></span><span class="op">(</span><span class="va">tab</span>,</span></span>
<span class="r-in"><span>                    horizontal<span class="op">=</span><span class="cn">FALSE</span>, auto.key<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                    main<span class="op">=</span><span class="st">"alwan.lamb"</span>, xlab<span class="op">=</span><span class="st">"Sire"</span>, ylab<span class="op">=</span><span class="st">"Proportion of lambs"</span>,</span></span>
<span class="r-in"><span>                    scales<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rot<span class="op">=</span><span class="fl">70</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    par.settings <span class="op">=</span> <span class="fu">simpleTheme</span><span class="op">(</span>col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yellow"</span>,<span class="st">"orange"</span>,<span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/detach.html" class="external-link">detach</a></span><span class="op">(</span><span class="st">"package:ordinal"</span><span class="op">)</span> <span class="co"># to avoid VarCorr clash with lme4</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

